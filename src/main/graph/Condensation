package graph;

import java.util.*;


public class Condensation {


    public static Map<String, List<String>> buildCondensation(List<List<String>> sccList,
                                                              Map<String, List<String>> graph) {

        Map<String, Integer> compIndex = new HashMap<>();
        for (int i = 0; i < sccList.size(); i++) {
            for (String v : sccList.get(i)) {
                compIndex.put(v, i);
            }
        }

        Map<String, List<String>> condensed = new HashMap<>();
        for (int i = 0; i < sccList.size(); i++) {
            condensed.put("C" + i, new ArrayList<>());
        }

        for (var entry : graph.entrySet()) {
            String u = entry.getKey();
            for (String v : entry.getValue()) {
                int cu = compIndex.get(u);
                int cv = compIndex.get(v);
                if (cu != cv) {
                    String from = "C" + cu;
                    String to = "C" + cv;
                    List<String> adj = condensed.get(from);
                    if (!adj.contains(to)) {
                        adj.add(to);
                    }
                }
            }
        }

        return condensed;
    }

    public static void printCondensation(Map<String, List<String>> condensation) {
        System.out.println("\nCondensation Graph:");
        for (var entry : condensation.entrySet()) {
            System.out.println(" " + entry.getKey() + " -> " + entry.getValue());
        }
    }
}
